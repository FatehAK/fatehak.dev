---
import NavLink from './NavLink.astro';
import Social from './Social.astro';
import ThemeToggle from './ThemeToggle.astro';

const pages = [
  {
    name: 'home',
    path: '/',
  },
  {
    name: 'blog',
    path: '/blog',
  },
  {
    name: 'about',
    path: '/about',
  },
  {
    name: 'snippets',
    path: '/snippets',
  },
];
---

<header id="nav-container" class="fixed z-10 top-0 left-0 w-full flex justify-center items-center bg-bg-body">
  <nav class="w-full max-w-3xl flex justify-between items-center px-8 sm:px-6">
    {/* desktop navbar */}
    <div class="text-text-bold md:hidden">
      <ul class="unset flex gap-4 [&>li]:p-0">
        {
          pages.map(page => (
            <li>
              <NavLink href={page.path}>{page.name}</NavLink>
            </li>
          ))
        }
      </ul>
    </div>
    {/* mobile hamburger menu */}
    <div class="hidden md:block">
      <button id="ham-menu-open" class="text-text-bold text-lg">
        <i class="fa-solid fa-bars" aria-hidden="true" title="Open hamburger menu"></i>
        <span class="fa-sr-only">Open hamburger menu</span>
      </button>
      <section id="ham-menu" class="hide-menu z-20 fixed top-0 left-0 w-full h-full transition-transform bg-black/75 border-primary-main">
        <div class="flex flex-col justify-between bg-bg-body w-[75%] h-full drop-shadow-2xl px-6">
          <div class="flex justify-end">
            <button id="ham-menu-close" class="h-[5rem] text-xl xml-[1px] text-text-bold">
              <i class="fa-solid fa-xmark" aria-hidden="true" title="Close hamburger menu"></i>
              <span class="fa-sr-only">Close hamburger menu</span>
            </button>
          </div>
          <ul class="unset flex flex-col justify-center text-text-bold gap-8 [&>li]:p-0">
            {
              pages.map(page => (
                <li>
                  <NavLink href={page.path}>{page.name}</NavLink>
                </li>
              ))
            }
          </ul>
          <div class="py-10"><Social /></div>
        </div>
      </section>
    </div>
    {/* nav links right */}
    <div class="flex items-center">
      <ThemeToggle />
    </div>
  </nav>
</header>

<script>
  const hamMenu = document.querySelector('#ham-menu');
  const navContainer = document.querySelector('#nav-container');

  function showMenu() {
    hamMenu.classList.remove('hide-menu');
    hamMenu.classList.add('show-menu');
    document.body.style.overflow = 'hidden';
  }
  function hideMenu() {
    hamMenu.classList.remove('show-menu');
    hamMenu.classList.add('hide-menu');
    document.body.style.overflow = 'auto';
  }
  hamMenu.addEventListener('click', evt => {
    if (evt.target === hamMenu) hideMenu();
  });

  document.querySelector('#ham-menu-open').addEventListener('click', showMenu);
  document.querySelector('#ham-menu-close').addEventListener('click', hideMenu);
  window.addEventListener('scroll', function () {
    if (window.scrollY > 0) {
      navContainer.classList.add('scroll');
    } else {
      navContainer.classList.remove('scroll');
    }
  });
</script>

<style>
  header {
    height: 5rem;
    border: 0;
    border-bottom: 1px solid transparent;
    transition: all 0.3s;

    &.scroll {
      border-bottom: 1px solid theme('colors.border.nav');

      @media (min-width: theme('screens.md.max')) {
        height: 4.4rem;
      }
    }

    @media (max-width: theme('screens.md.max')) {
      height: 4.4rem;
    }
  }

  .hide-menu {
    transform: translateX(-100%);
  }

  .show-menu {
    transform: translateX(0%);
  }
</style>
